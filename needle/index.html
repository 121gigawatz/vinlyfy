<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description" content="Transform your digital audio into warm, nostalgic vinyl records with authentic vinyl effects.">
  <meta name="theme-color" content="#d4a574">
  
  <!-- PWA Meta Tags -->
  <link rel="manifest" href="/manifest.json">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Vinylfy">
  
  <!-- Icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/icon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/icon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/icon-180x180.png">
  
  <!-- Preconnect for performance -->
  <link rel="preconnect" href="/api">
  
  <title>Vinylfy - Vinyl Record Effect Processor</title>
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="/css/variables.css">
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/components.css">
  <link rel="stylesheet" href="/css/responsive.css">
</head>
<body>
  <!-- Header -->
  <header class="app-header container" style="padding-top: var(--space-xl); padding-bottom: var(--space-lg);">
    <div class="flex-between mobile-flex-col gap-md">
      <div class="text-center mobile-center">
        <h1 style="margin-bottom: var(--space-xs);">
          <span style="color: var(--color-primary);">üéµ Vinylfy</span>
        </h1>
        <p class="text-secondary" style="margin-bottom: 0;">Transform digital audio into warm vinyl records</p>
      </div>
      <div class="flex gap-sm" style="align-items: center;">
        <span id="healthStatus" class="badge badge-secondary">Checking...</span>
        <button id="installBtn" class="btn btn-ghost btn-sm hidden" aria-label="Install app">
          üì≤ Install
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container" style="padding-bottom: var(--space-3xl);">
    
    <!-- Upload Section -->
    <section class="section animate-slideUp">
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">1. Upload Your Audio</h2>
          <p class="card-subtitle">Select an audio file to vinylfy</p>
        </div>
        
        <div class="card-body">
          <div class="file-upload">
            <input 
              type="file" 
              id="audioFile" 
              accept="audio/*,.wav,.mp3,.flac,.ogg,.m4a,.aac"
              aria-label="Upload audio file"
            >
            <label for="audioFile" class="file-upload-label" id="fileUploadLabel">
              <div class="file-upload-icon">üéß</div>
              <div class="file-upload-text">Click or drag audio file here</div>
              <div class="file-upload-hint">Supports: WAV, MP3, FLAC, OGG, M4A, AAC (Max 25MB)</div>
            </label>
          </div>
          
          <!-- File Info -->
          <div id="fileInfo" class="hidden" style="margin-top: var(--space-lg);">
            <div class="alert alert-success">
              <strong>File loaded:</strong> <span id="fileName"></span>
              <br>
              <strong>Size:</strong> <span id="fileSize"></span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Settings Section -->
    <section class="section animate-slideUp" style="animation-delay: 0.1s;">
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">2. Choose Your Vinyl Effect</h2>
          <p class="card-subtitle">Select a preset or customize your own</p>
        </div>
        
        <div class="card-body">
          <!-- Preset Selector -->
          <div class="form-row">
            <div class="form-group">
              <label for="presetSelector" class="form-label">Vinyl Preset</label>
              <select id="presetSelector" class="form-select">
                <option value="light">Light - Subtle vinyl character</option>
                <option value="medium" selected>Medium - Classic vinyl sound</option>
                <option value="heavy">Heavy - Well-worn record</option>
                <option value="vintage">Vintage - Old, heavily-played</option>
                <option value="custom">Custom - Full control</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="formatSelector" class="form-label">Output Format</label>
              <select id="formatSelector" class="form-select">
                <option value="wav" selected>WAV (Highest Quality)</option>
                <option value="mp3">MP3 (Smaller Size)</option>
                <option value="flac">FLAC (Lossless)</option>
                <option value="ogg">OGG (Compressed)</option>
              </select>
            </div>
          </div>

          <!-- Custom Controls -->
          <div id="customControls" class="hidden" style="margin-top: var(--space-xl); padding-top: var(--space-xl); border-top: 1px solid var(--color-border);">
            <h3 style="margin-bottom: var(--space-lg); color: var(--color-primary);">Custom Settings</h3>
            
            <!-- Frequency Response -->
            <div class="form-group">
              <label class="toggle">
                <input type="checkbox" id="frequencyResponse" class="toggle-input" checked>
                <span class="toggle-switch"></span>
                <span>Frequency Response (RIAA curve)</span>
              </label>
            </div>

            <!-- Surface Noise -->
            <div class="form-group">
              <label class="toggle">
                <input type="checkbox" id="surfaceNoise" class="toggle-input" checked>
                <span class="toggle-switch"></span>
                <span>Surface Noise (crackles & pops)</span>
              </label>
            </div>
            
            <div class="range-group">
              <div class="range-label">
                <span>Noise Intensity</span>
                <span class="range-value" id="noiseIntensityValue">0.020</span>
              </div>
              <input 
                type="range" 
                id="noiseIntensity" 
                class="range-input"
                min="0" 
                max="0.1" 
                step="0.001" 
                value="0.02"
              >
            </div>

            <!-- Wow & Flutter -->
            <div class="form-group">
              <label class="toggle">
                <input type="checkbox" id="wowFlutter" class="toggle-input" checked>
                <span class="toggle-switch"></span>
                <span>Wow & Flutter (pitch variations)</span>
              </label>
            </div>
            
            <div class="range-group">
              <div class="range-label">
                <span>Wow/Flutter Intensity</span>
                <span class="range-value" id="wowFlutterValue">0.0010</span>
              </div>
              <input 
                type="range" 
                id="wowFlutterIntensity" 
                class="range-input"
                min="0" 
                max="0.01" 
                step="0.0001" 
                value="0.001"
              >
            </div>

            <!-- Harmonic Distortion -->
            <div class="form-group">
              <label class="toggle">
                <input type="checkbox" id="harmonicDistortion" class="toggle-input" checked>
                <span class="toggle-switch"></span>
                <span>Harmonic Distortion (analog warmth)</span>
              </label>
            </div>
            
            <div class="range-group">
              <div class="range-label">
                <span>Distortion Amount</span>
                <span class="range-value" id="distortionValue">0.15</span>
              </div>
              <input 
                type="range" 
                id="distortionAmount" 
                class="range-input"
                min="0" 
                max="1" 
                step="0.01" 
                value="0.15"
              >
            </div>

            <!-- Stereo Reduction -->
            <div class="form-group">
              <label class="toggle">
                <input type="checkbox" id="stereoReduction" class="toggle-input" checked>
                <span class="toggle-switch"></span>
                <span>Stereo Reduction (limited separation)</span>
              </label>
            </div>
            
            <div class="range-group">
              <div class="range-label">
                <span>Stereo Width</span>
                <span class="range-value" id="stereoWidthValue">0.70</span>
              </div>
              <input 
                type="range" 
                id="stereoWidth" 
                class="range-input"
                min="0" 
                max="1" 
                step="0.01" 
                value="0.7"
              >
            </div>
          </div>
        </div>

        <!-- Process Button -->
        <div class="card-footer">
          <button id="processBtn" class="btn btn-primary btn-lg btn-full" disabled>
            üéµ Process Audio
          </button>
        </div>
      </div>
    </section>

    <!-- Processing Indicator -->
    <section id="processingIndicator" class="section hidden animate-fadeIn">
      <div class="card card-elevated text-center">
        <div class="vinyl-record spinning" style="margin: 0 auto var(--space-lg);"></div>
        <h3 style="color: var(--color-primary);">Processing Your Audio...</h3>
        <p class="text-secondary">Adding that warm vinyl character üé∂</p>
      </div>
    </section>

    <!-- Results Section -->
    <section id="resultsSection" class="section hidden animate-slideUp">
      <div class="card card-elevated">
        <div class="card-header">
          <h2 class="card-title">3. Preview & Download</h2>
          <p class="card-subtitle">Your vinylified audio is ready!</p>
        </div>
        
        <div class="card-body">
          <!-- File Details -->
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-md); margin-bottom: var(--space-lg);">
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Filename</div>
              <div id="resultFileName" style="font-weight: var(--font-weight-medium); word-break: break-all;">-</div>
            </div>
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Size</div>
              <div id="resultFileSize" style="font-weight: var(--font-weight-medium);">-</div>
            </div>
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Preset</div>
              <div id="resultPreset" style="font-weight: var(--font-weight-medium);">-</div>
            </div>
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Format</div>
              <div id="resultFormat" style="font-weight: var(--font-weight-medium);">-</div>
            </div>
          </div>

          <div class="alert alert-info">
            ‚è±Ô∏è This file will expire in <strong id="expiresIn">-</strong>
          </div>

          <!-- Audio Player -->
          <div id="audioPlayerContainer" class="hidden"></div>

          <!-- Action Buttons -->
          <div class="btn-group" style="margin-top: var(--space-lg);">
            <button id="previewBtn" class="btn btn-secondary btn-lg">
              üéß Preview
            </button>
            <button id="downloadBtn" class="btn btn-primary btn-lg">
              ‚¨á Download
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Info Section -->
    <section class="section animate-slideUp" style="animation-delay: 0.2s;">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">About Vinylfy</h3>
        </div>
        <div class="card-body">
          <p>Vinylfy transforms your digital audio into warm, nostalgic vinyl records by simulating authentic vinyl characteristics:</p>
          <ul style="list-style: disc; padding-left: var(--space-xl); margin-top: var(--space-md);">
            <li style="margin-bottom: var(--space-sm); color: var(--color-text-secondary);">
              <strong style="color: var(--color-text-primary);">Surface Noise</strong> - Authentic crackles, pops, and background hiss
            </li>
            <li style="margin-bottom: var(--space-sm); color: var(--color-text-secondary);">
              <strong style="color: var(--color-text-primary);">Frequency Response</strong> - RIAA equalization curve with natural rolloff
            </li>
            <li style="margin-bottom: var(--space-sm); color: var(--color-text-secondary);">
              <strong style="color: var(--color-text-primary);">Wow & Flutter</strong> - Turntable speed variations for organic feel
            </li>
            <li style="margin-bottom: var(--space-sm); color: var(--color-text-secondary);">
              <strong style="color: var(--color-text-primary);">Harmonic Distortion</strong> - Analog warmth through soft clipping
            </li>
            <li style="color: var(--color-text-secondary);">
              <strong style="color: var(--color-text-primary);">Stereo Reduction</strong> - Limited stereo separation like real vinyl
            </li>
          </ul>
        </div>
      </div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="app-footer text-center" style="padding: var(--space-xl) 0; border-top: 1px solid var(--color-border);">
    <p class="text-muted" style="font-size: var(--font-size-sm);">
      Made with ‚ù§Ô∏è for vinyl enthusiasts
    </p>
  </footer>

  <!-- Scripts -->
  <script type="module" src="/js/app.js"></script>
</body>
</html>