<!DOCTYPE html>
<html lang="en">
  <!-- TO DO: Enable HTTP Basic Login -->
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description" content="Transform your digital audio into warm, nostalgic vinyl records with authentic vinyl effects.">
  <meta name="theme-color" content="#d4a574">
  
  <!-- PWA Meta Tags -->
  <link rel="manifest" href="/manifest.json">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Vinylfy">
  
  <!-- Icons -->
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/svg+xml" href="/assets/icons/favicon.svg">
  <link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png">
  
  <!-- Preconnect for performance -->
  <link rel="preconnect" href="/api">
  
  <title>Vinylfy - Vinyl Record Effect Processor</title>
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="/css/variables.css">
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/components.css">
  <link rel="stylesheet" href="/css/responsive.css">
</head>
<body>
  <!-- Header -->
  <header class="app-header container" style="padding-top: var(--space-xl); padding-bottom: var(--space-lg);">
    <div class="flex-between mobile-flex-col gap-md">
      <div>
        <h1 style="margin-bottom: var(--space-xs); display: flex; align-items: center; gap: var(--space-sm);">
          <img src="assets/icons/favicon-96x96.png" alt="Vinylfy icon" style="width: 48px; height: 48px;">
          <span style="color: var(--color-primary);">Vinylfy</span>
        </h1>
      </div>
      <div class="flex gap-sm" style="align-items: center;">
        <div class="theme-toggle-group" style="display: flex; gap: 4px; background: var(--color-bg-secondary); border-radius: var(--radius-md); padding: 2px;">
          <button id="themeLight" class="theme-toggle-btn" data-theme="light" aria-label="Light mode" title="Light mode">‚òÄÔ∏è</button>
          <button id="themeDark" class="theme-toggle-btn" data-theme="dark" aria-label="Dark mode" title="Dark mode">üåô</button>
          <button id="themeAuto" class="theme-toggle-btn active" data-theme="auto" aria-label="Auto mode" title="Auto mode">Auto</button>
        </div>
        <span id="healthStatus" class="badge badge-secondary">Checking...</span>
        <button id="installBtn" class="btn btn-ghost btn-sm hidden" aria-label="Install app">
          üì≤ Install
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container" style="padding-bottom: var(--space-3xl);">
    
    <!-- Hero Section -->
    <section class="hero animate-fadeIn">
      <div class="hero-content">
        <div class="vinyl-record spinning" style="margin: 0 auto var(--space-sm); width: 80px; height: 80px;"></div>
        <h1 class="hero-title">Give Your Digital Music That Vinyl Sound</h1>
        <p class="hero-subtitle">Transform digital audio into warm, nostalgic vinyl records</p>
        <div class="hero-features">
          <span class="hero-feature">üéß Authentic Sound</span>
          <span class="hero-feature">‚ö° Fast Processing</span>
          <span class="hero-feature">üì± Any Device</span>
          <span class="hero-feature">üéµ Multiple Formats</span>
        </div>
      </div>
    </section>
    
    <!-- Two Column Layout: Steps 1 & 2 + How It Works -->
    <div class="two-column-layout" style="margin-bottom: var(--space-xl);">

      <!-- Left Column: Step 1 + How It Works -->
      <div style="display: flex; flex-direction: column; gap: var(--space-sm);">

        <!-- Upload Section (Step 1) -->
        <section class="section animate-slideUp" style="margin-bottom: 0;">
          <div class="card card-glow gradient-border">
            <div class="card-header">
              <div style="display: flex; align-items: center; gap: var(--space-md);">
                <span class="step-indicator">1</span>
                <div>
                  <h2 class="card-title" style="margin-bottom: var(--space-xs);">Upload Your Audio</h2>
                  <p class="card-subtitle">Select an audio file to vinylfy</p>
                </div>
              </div>
            </div>

            <div class="card-body">
              <div class="file-upload">
                <input
                  type="file"
                  id="audioFile"
                  accept="audio/*,.wav,.mp3,.flac,.ogg,.m4a,.aac"
                  aria-label="Upload audio file"
                >
                <label for="audioFile" class="file-upload-label" id="fileUploadLabel">
                  <div class="file-upload-icon">üéß</div>
                  <div class="file-upload-text">Click or drag audio file here</div>
                  <div class="file-upload-hint">Supports: WAV, MP3, FLAC, OGG, M4A, AAC (Max 25MB)</div>
                </label>
              </div>

              <!-- File Info -->
              <div id="fileInfo" class="hidden" style="margin-top: var(--space-lg);">
                <div class="alert alert-success">
                  <strong>File loaded:</strong> <span id="fileName"></span>
                  <br>
                  <strong>Size:</strong> <span id="fileSize"></span>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- How It Works Section -->
        <section id="howItWorks" class="section animate-slideUp" style="animation-delay: 0.2s; margin-bottom: 0; margin-top: var(--space-md); transition: margin-top var(--transition-base);">
          <div class="card" style="height: 100%;">
            <div class="card-header">
              <div style="display: flex; align-items: center; gap: var(--space-md);">
                <div class="card-header-icon">‚ÑπÔ∏è</div>
                <h3 class="card-title" style="margin-bottom: 0;">How It Works</h3>
              </div>
            </div>
            <div class="card-body">
              <p style="font-size: var(--font-size-xs); margin-bottom: var(--space-xs); color: var(--color-text-secondary);">
                Authentic vinyl simulation with:
              </p>
              <div style="display: grid; gap: 6px;">
                <div style="display: flex; gap: var(--space-xs); align-items: center;">
                  <span style="font-size: var(--font-size-sm);">üîä</span>
                  <span style="color: var(--color-text-primary); font-size: var(--font-size-sm);">Surface Noise</span>
                </div>
                <div style="display: flex; gap: var(--space-xs); align-items: center;">
                  <span style="font-size: var(--font-size-sm);">üìâ</span>
                  <span style="color: var(--color-text-primary); font-size: var(--font-size-sm);">Frequency Response</span>
                </div>
                <div style="display: flex; gap: var(--space-xs); align-items: center;">
                  <span style="font-size: var(--font-size-sm);">üåä</span>
                  <span style="color: var(--color-text-primary); font-size: var(--font-size-sm);">Wow & Flutter</span>
                </div>
                <div style="display: flex; gap: var(--space-xs); align-items: center;">
                  <span style="font-size: var(--font-size-sm);">üî•</span>
                  <span style="color: var(--color-text-primary); font-size: var(--font-size-sm);">Harmonic Distortion</span>
                </div>
                <div style="display: flex; gap: var(--space-xs); align-items: center;">
                  <span style="font-size: var(--font-size-sm);">üéöÔ∏è</span>
                  <span style="color: var(--color-text-primary); font-size: var(--font-size-sm);">Stereo Reduction</span>
                </div>
              </div>
            </div>
          </div>
        </section>

      </div>
      <!-- End Left Column -->

      <!-- Right Column: Step 2 -->
      <div>

        <!-- Settings Section (Step 2) -->
        <section class="section animate-slideUp" style="animation-delay: 0.1s; margin-bottom: 0;">
      <div class="card card-glow gradient-border" style="display: flex; flex-direction: column; height: 100%;">
        <div class="card-header">
          <div style="display: flex; align-items: center; gap: var(--space-md);">
            <span class="step-indicator">2</span>
            <div>
              <h2 class="card-title" style="margin-bottom: var(--space-xs);">Choose Your Vinyl Effect</h2>
              <p class="card-subtitle">Select a preset or customize your own</p>
            </div>
          </div>
        </div>

        <div class="card-body" style="flex: 1;">
          <!-- Preset Selector -->
          <div class="form-row">
            <div class="form-group">
              <label for="presetSelector" class="form-label">Vinyl Preset</label>
              <select id="presetSelector" class="form-select">
                <option value="light">Light - Subtle vinyl character</option>
                <option value="medium" selected>Medium - Classic vinyl sound</option>
                <option value="heavy">Heavy - Well-worn record</option>
                <option value="vintage">Vintage - Old, heavily-played</option>
                <option value="custom">Custom - Full control</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="formatSelector" class="form-label">Output Format</label>
              <select id="formatSelector" class="form-select">
                <option value="wav">WAV (Highest Quality)</option>
                <option value="mp3" selected>MP3 (Smaller Size)</option>
                <option value="flac">FLAC (Lossless)</option>
                <option value="ogg">OGG (Compressed)</option>
              </select>
            </div>
          </div>

          <!-- Custom Controls -->
          <div id="customControls" style="margin-top: var(--space-md); padding-top: var(--space-md); border-top: 1px solid var(--color-border);">
            <h3 style="margin-bottom: var(--space-md); color: var(--color-primary); font-size: var(--font-size-lg);">Custom Settings</h3>
            
            <!-- Frequency Response -->
            <div class="form-group">
              <label class="toggle">
                <input type="checkbox" id="frequencyResponse" class="toggle-input" checked>
                <span class="toggle-switch"></span>
                <span>Frequency Response (RIAA curve)</span>
              </label>
            </div>

            <!-- Surface Noise -->
            <div class="form-group">
              <label class="toggle">
                <input type="checkbox" id="surfaceNoise" class="toggle-input" checked>
                <span class="toggle-switch"></span>
                <span>Surface Noise (crackles & pops)</span>
              </label>
            </div>
            
            <div class="range-group">
              <div class="range-label">
                <span>Noise Intensity</span>
                <span class="range-value" id="noiseIntensityValue">0.020</span>
              </div>
              <input 
                type="range" 
                id="noiseIntensity" 
                class="range-input"
                min="0" 
                max="0.1" 
                step="0.001" 
                value="0.02"
              >
            </div>

            <!-- Wow & Flutter -->
            <div class="form-group">
              <label class="toggle">
                <input type="checkbox" id="wowFlutter" class="toggle-input" checked>
                <span class="toggle-switch"></span>
                <span>Wow & Flutter (pitch variations)</span>
              </label>
            </div>
            
            <div class="range-group">
              <div class="range-label">
                <span>Wow/Flutter Intensity</span>
                <span class="range-value" id="wowFlutterValue">0.0010</span>
              </div>
              <input 
                type="range" 
                id="wowFlutterIntensity" 
                class="range-input"
                min="0" 
                max="0.01" 
                step="0.0001" 
                value="0.001"
              >
            </div>

            <!-- Harmonic Distortion -->
            <div class="form-group">
              <label class="toggle">
                <input type="checkbox" id="harmonicDistortion" class="toggle-input" checked>
                <span class="toggle-switch"></span>
                <span>Harmonic Distortion (analog warmth)</span>
              </label>
            </div>
            
            <div class="range-group">
              <div class="range-label">
                <span>Distortion Amount</span>
                <span class="range-value" id="distortionValue">0.15</span>
              </div>
              <input 
                type="range" 
                id="distortionAmount" 
                class="range-input"
                min="0" 
                max="1" 
                step="0.01" 
                value="0.15"
              >
            </div>

            <!-- Stereo Reduction -->
            <div class="form-group">
              <label class="toggle">
                <input type="checkbox" id="stereoReduction" class="toggle-input" checked>
                <span class="toggle-switch"></span>
                <span>Stereo Reduction (limited separation)</span>
              </label>
            </div>
            
            <div class="range-group">
              <div class="range-label">
                <span>Stereo Width</span>
                <span class="range-value" id="stereoWidthValue">0.70</span>
              </div>
              <input 
                type="range" 
                id="stereoWidth" 
                class="range-input"
                min="0" 
                max="1" 
                step="0.01" 
                value="0.7"
              >
            </div>
          </div>
        </div>

        <!-- Process Button -->
        <div class="card-footer">
          <button id="processBtn" class="btn btn-primary btn-lg btn-full" disabled>
            Process Audio
          </button>
        </div>
      </div>
    </section>

      </div>
      <!-- End Right Column -->

    </div>
    <!-- End Two Column Layout -->

    <!-- Processing Indicator -->
    <section id="processingIndicator" class="section hidden animate-fadeIn">
      <div class="card card-elevated text-center">
        <div class="vinyl-record spinning" style="margin: 0 auto var(--space-lg);"></div>
        <h3 style="color: var(--color-primary);">Processing Your Audio...</h3>
        <p class="text-secondary">Adding that warm vinyl character üé∂</p>
      </div>
    </section>

    <!-- Results Section -->
    <section id="resultsSection" class="section hidden animate-slideUp">
      <div class="card card-elevated card-glow gradient-border">
        <div class="card-header">
          <div style="display: flex; align-items: center; gap: var(--space-md);">
            <span class="step-indicator">3</span>
            <div>
              <h2 class="card-title" style="margin-bottom: var(--space-xs);">Preview & Download</h2>
              <p class="card-subtitle">Your vinylified audio is ready! üéâ</p>
            </div>
          </div>
        </div>
        
        <div class="card-body">
          <!-- File Details -->
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-md); margin-bottom: var(--space-lg);">
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Filename</div>
              <div id="resultFileName" style="font-weight: var(--font-weight-medium); word-break: break-all;">-</div>
            </div>
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Size</div>
              <div id="resultFileSize" style="font-weight: var(--font-weight-medium);">-</div>
            </div>
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Preset</div>
              <div id="resultPreset" style="font-weight: var(--font-weight-medium);">-</div>
            </div>
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Format</div>
              <div id="resultFormat" style="font-weight: var(--font-weight-medium);">-</div>
            </div>
          </div>

          <div class="alert alert-info">
            ‚è±Ô∏è This file will expire in <strong id="expiresIn">-</strong>
          </div>

          <!-- Audio Player -->
          <div id="audioPlayerContainer" class="hidden"></div>

          <!-- Action Buttons -->
          <div class="btn-group" style="margin-top: var(--space-lg);">
            <button id="previewBtn" class="btn btn-secondary btn-lg">
              üéß Preview
            </button>
            <button id="downloadBtn" class="btn btn-primary btn-lg">
              ‚¨á Download
            </button>
            <button id="discardBtn" class="btn btn-ghost btn-lg" style="border: 1px solid var(--color-error);">
              üóëÔ∏è Discard
            </button>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="app-footer text-center" style="padding: var(--space-2xl) 0; border-top: 1px solid var(--color-border); background: linear-gradient(180deg, transparent 0%, rgba(212, 165, 116, 0.05) 100%);">
    <div class="container">
      <img src="assets/icons/favicon-96x96.png" alt="Vinylfy icon" style="width: 60px; height: 60px; margin: 0 auto var(--space-md); display: block;">
      <p style="font-size: var(--font-size-lg); color: var(--color-primary); font-weight: var(--font-weight-medium); margin-bottom: var(--space-sm);">
        Vinylfy
      </p> 
      <p style="font-size: var(--font-size-sm); color: var(--color-primary); font-weight: var(--font-weight-light); margin-bottom: var(--space-sm);">
        <!-- TO DO: Update version number to match version number in app.js -->
        Version: BETA 2
      </p>
      <p class="text-muted" style="font-size: var(--font-size-sm); margin-bottom: var(--space-md);">
        Transform digital audio into warm vinyl records
      </p>
      <div style="display: flex; gap: var(--space-lg); justify-content: center; flex-wrap: wrap; font-size: var(--font-size-sm); color: var(--color-text-secondary);">
        <span>üéµ Authentic Sound</span>
        <span>‚ö° Fast Processing</span>
        <span>üîí Privacy First</span>
        <span>üì± PWA Ready</span>
      </div>
      <p class="text-muted" style="font-size: var(--font-size-xs); margin-top: var(--space-lg);">
        <!-- TO DO: update the File auto delete to match env configuration -->
        Made with ‚ù§Ô∏è for AJW and vinyl enthusiasts ‚Ä¢ Files auto-delete after 1 hour
      </p>
    </div>
  </footer>

  <!-- Scripts -->
  <script type="module" src="/js/app.js"></script>
</body>
</html>