<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description"
    content="Transform your digital audio into warm, nostalgic vinyl records with authentic vinyl effects.">
  <meta name="theme-color" content="#d4a574">

  <!-- PWA Meta Tags -->
  <link rel="manifest" href="/manifest.json">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Vinylfy">

  <!-- Icons -->
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/svg+xml" href="/assets/icons/favicon.svg">
  <link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png">

  <!-- Preconnect for performance -->
  <link rel="preconnect" href="/api">

  <title>Vinylfy</title>

  <!-- Stylesheets -->
  <link rel="stylesheet" href="/css/variables.css?v=beta3">
  <link rel="stylesheet" href="/css/base.css?v=beta3">
  <link rel="stylesheet" href="/css/components.css?v=beta3">
  <link rel="stylesheet" href="/css/responsive.css?v=beta3">

  <!-- Driver.js for product tours -->
  <link rel="stylesheet" href="/css/vendor/driver.css?v=beta3">
  <script src="/js/vendor/driver.js?v=beta3"></script>
</head>

<body>
  <!-- Skip Navigation -->
  <a href="#main-content" class="skip-link">Go to Vinylfy configurator</a>
  <!-- Screen Reader Announcements for Accessibility-->
  <div id="aria-live-region" aria-live="polite" aria-atomic="true" class="sr-only"></div>
  <!-- Header -->
  <header class="app-header container" style="padding-top: var(--space-xs); padding-bottom: var(--space-lg);">
    <div class="flex-between mobile-flex-col gap-md">
      <div>
        <h1 style="margin-bottom: var(--space-xs); display: flex; align-items: center; gap: var(--space-sm);">
          <img src="assets/icons/favicon-96x96.png" alt="Vinylfy icon" style="width: 48px; height: 48px;">
          <span style="color: var(--color-primary);">Vinylfy</span>
        </h1>
      </div>
      <div class="flex gap-sm" style="align-items: center;">
        <!-- GitHub Link -->
        <a id="githubLink" href="https://github.com/121gigawatz/vinylfy" target="_blank" rel="noopener noreferrer"
          class="github-link" title="View on GitHub">
          <svg class="github-icon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true">
            <path fill="currentColor"
              d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
            </path>
          </svg>
          <span id="starCount" class="star-count">
            <span class="star-icon">‚≠ê</span>
            <span id="starNumber">‚Äî</span>
          </span>
        </a>

        <div class="theme-toggle-group"
          style="display: flex; gap: 4px; background: var(--color-bg-secondary); border-radius: var(--radius-md); padding: 2px;">
          <button id="themeLight" class="theme-toggle-btn" data-theme="light" aria-label="Light mode"
            title="Light mode">‚òÄÔ∏è</button>
          <button id="themeDark" class="theme-toggle-btn" data-theme="dark" aria-label="Dark mode"
            title="Dark mode">üåô</button>
          <button id="themeAuto" class="theme-toggle-btn active" data-theme="auto" aria-label="Auto mode"
            title="Auto mode">Auto</button>
        </div>
        <span id="healthStatus" class="badge badge-secondary">Checking...</span>
        <button id="installBtn" class="btn btn-ghost btn-sm hidden"
          aria-label="Install Vinylfy as a progressive web app">
          <span aria-hidden="true">üì≤</span> Install
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main id="main-content" class="container" style="padding-bottom: var(--space-xs);">

    <!-- Hero Section -->
    <section class="hero animate-fadeIn">
      <div class="hero-content">
        <h1 class="hero-title">Give Your Digital Music That Vinyl Sound</h1>
        <p class="hero-subtitle">Transform digital audio into warm, nostalgic vinyl records</p>
        <div class="hero-features">
          <span class="hero-feature"><span aria-hidden="true">üéß</span> Authentic Sound</span>
          <span class="hero-feature"><span aria-hidden="true">‚ö°</span> Fast Processing</span>
          <span class="hero-feature"><span aria-hidden="true">üì±</span> Any Device</span>
          <span class="hero-feature"><span aria-hidden="true">üéµ</span> Multiple Formats</span>
        </div>
      </div>
    </section>

    <!-- Step 1: Upload Your Audio -->
    <section class="section animate-slideUp">
      <div class="card card-glow gradient-border">
        <div class="card-header">
          <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
            <div style="display: flex; align-items: center; gap: var(--space-xs);">
              <span class="step-indicator">1</span>
              <div>
                <h2 class="card-title" style="margin-bottom: var(--space-xs);">Upload Your Audio</h2>
                <p class="card-subtitle">Select an audio file to vinylfy</p>
              </div>
            </div>
            <button class="help-btn" data-tour="upload" title="Learn about uploading audio files"
              aria-label="Help: Learn about uploading audio files">
              ?
            </button>
          </div>
        </div>

        <div class="card-body">
          <div class="file-upload">
            <input type="file" id="audioFile" accept="audio/*,.wav,.mp3,.flac,.ogg,.m4a,.aac"
              aria-label="Upload audio file">
            <label for="audioFile" class="file-upload-label" id="fileUploadLabel">
              <div class="file-upload-icon"><span aria-hidden="true">üéß</span></div>
              <div class="file-upload-text">Click or drag audio file here</div>
              <div class="file-upload-hint" id="fileUploadHint">Supports: WAV, MP3, FLAC, OGG, M4A, AAC (Max 25MB)</div>
            </label>
          </div>

          <!-- File Info -->
          <div id="fileInfo" class="hidden" style="margin-top: var(--space-xs);">
            <div class="alert alert-success">
              <strong>File loaded:</strong> <span id="fileName"></span>
              <br>
              <strong>Size:</strong> <span id="fileSize"></span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Step 2: Configure Settings -->
    <section class="section animate-slideUp" style="animation-delay: 0.1s;">
      <div class="card card-glow gradient-border">
        <div class="card-header">
          <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
            <div style="display: flex; align-items: center; gap: var(--space-xs);">
              <span class="step-indicator">2</span>
              <div>
                <h2 class="card-title" style="margin-bottom: var(--space-sm);">Choose Your Vinyl Effect</h2>
                <p class="card-subtitle">Select a preset or customize your own</p>
              </div>
            </div>
            <button class="help-btn" data-tour="vinyl-effects" title="Learn about vinyl effects and settings"
              aria-label="Help: Learn about vinyl effects and settings">
              ?
            </button>
          </div>
        </div>

        <div class="card-body">
          <!-- Preset and Format Selectors -->
          <div class="form-row" style="margin-bottom: var(--space-xs);">
            <div class="form-group">
              <label for="presetSelector" class="form-label">Vinyl Preset</label>
              <select id="presetSelector" class="form-select">
                <option value="AJW Recommended" selected>AJW Recommended</option>
                <option value="1920's Jazz">1920's Jazz</option>
                <option value="1930's Swing">1930's Swing</option>
                <option value="1940's Big Band">1940's Big Band</option>
                <option value="1950's Rock & Roll">1950's Rock & Roll</option>
                <option value="1950's Rhythm & Blues">1950's Rhythm & Blues</option>
                <option value="1960's Pop">1960's Pop</option>
                <option value="1960's Psychedelic">1960's Psychedelic</option>
                <option value="1970's Rock">1970's Rock</option>
                <option value="1970's Disco">1970's Disco</option>
                <option value="1970's Funk">1970's Funk</option>
                <option value="1980's New Wave">1980's New Wave</option>
                <option value="1980's Metal">1980's Metal</option>
                <option value="1990's Alternative">1990's Alternative</option>
                <option value="1990's Hip-Hop">1990's Hip-Hop</option>
                <option value="2000's Pop">2000's Pop</option>
                <option value="2000's Indie">2000's Indie</option>
                <option value="2010's Pop">2010's Pop</option>
                <option value="2010's Electronic">2010's Electronic</option>
                <option value="2020's Modern Vinyl">2020's Modern Vinyl</option>
                <option value="custom">Custom - Full control</option>
              </select>
            </div>

            <div class="form-group">
              <label for="formatSelector" class="form-label">Output Format</label>
              <select id="formatSelector" class="form-select">
                <option value="aac">AAC (High Quality, Smaller)</option>
                <option value="mp3" selected>MP3 (Most Compatible)</option>
                <option value="flac">FLAC (Lossless)</option>
                <option value="ogg">OGG (Compressed)</option>
                <option value="wav">WAV (Highest Quality)</option>
              </select>
            </div>
          </div>

          <!-- Custom Controls in Two Columns -->
          <div id="customControls" style="padding-top: var(--space-xs); border-top: 1px solid var(--color-border);">
            <h3 style="margin-bottom: var(--space-xs); color: var(--color-primary); font-size: var(--font-size-lg);">
              Custom Settings</h3>

            <div class="two-column-layout">
              <!-- Left Column Controls -->
              <div>
                <!-- Frequency Response -->
                <div class="form-group">
                  <label class="toggle">
                    <input type="checkbox" id="frequencyResponse" class="toggle-input" role="switch" aria-checked="true"
                      aria-label="Enable frequency reponse with RIAA curve" checked>
                    <span class="toggle-switch" aria-hidden="true"></span>
                    <span>Frequency Response (RIAA curve)</span>
                  </label>
                </div>

                <!-- Surface Noise -->
                <div class="form-group" id="surfaceNoiseToggle">
                  <label class="toggle">
                    <input type="checkbox" id="surfaceNoise" class="toggle-input" role="switch" aria-checked="true"
                      aria-label="Enable surface noise with crackles and pops" checked>
                    <span class="toggle-switch" aria-hidden="true"></span>
                    <span>Surface Noise (crackles & pops)</span>
                  </label>
                </div>

                <!-- Noise Intensity -->
                <div class="range-group" id="noiseIntensityGroup">
                  <div class="range-label">
                    <label for="noiseIntensity">Noise Intensity</label>
                    <span class="range-value" id="noiseIntensityValue" aria-live="polite">0.020</span>
                  </div>
                  <input type="range" id="noiseIntensity" class="range-input" min="0" max="0.1" step="0.001"
                    value="0.02" aria-label="Noise intensity level" aria-valuemin="0" aria-valuemax="0.1"
                    aria-valuenow="0.02" aria-valuetext="0.020">
                </div>

                <div class="range-group" id="popIntensityGroup">
                  <div class="range-label">
                    <label for="popIntensity">Pop Intensity</label>
                    <span class="range-value" id="popIntensityValue" aria-live="polite">0.60</span>
                  </div>
                  <input type="range" id="popIntensity" class="range-input" min="0" max="1.0" step="0.05" value="0.6"
                    aria-label="Pop and crackle intensity level" aria-valuemin="0" aria-valuemax="1.0"
                    aria-valuenow="0.6" aria-valuetext="0.60">
                </div>

                <!-- Wow & Flutter -->
                <div class="form-group">
                  <label class="toggle">
                    <input type="checkbox" id="wowFlutter" class="toggle-input" role="switch" aria-checked="true"
                      aria-label="Enable wow and flutter pitch variations" checked>
                    <span class="toggle-switch" aria-hidden="true"></span>
                    <span>Wow & Flutter (pitch variations)</span>
                  </label>
                </div>

                <div class="range-group" id="wowFlutterIntensityGroup">
                  <div class="range-label">
                    <label for="wowFlutterIntensity">Wow/Flutter Intensity</label>
                    <span class="range-value" id="wowFlutterValue" aria-live="polite">0.0010</span>
                  </div>
                  <input type="range" id="wowFlutterIntensity" class="range-input" min="0" max="0.01" step="0.0001"
                    value="0.001" aria-label="Wow and flutter pitch variation intensity" aria-valuemin="0"
                    aria-valuemax="0.01" aria-valuenow="0.001" aria-valuetext="0.0010">
                </div>

                <!-- Harmonic Distortion -->
                <div class="form-group">
                  <label class="toggle">
                    <input type="checkbox" id="harmonicDistortion" class="toggle-input" role="switch"
                      aria-checked="true" aria-label="Enable harmonic distortion for analog warmth" checked>
                    <span class="toggle-switch" aria-hidden="true"></span>
                    <span>Harmonic Distortion (analog warmth)</span>
                  </label>
                </div>

                <div class="range-group" id="distortionAmountGroup">
                  <div class="range-label">
                    <label for="distortionAmount">Distortion Amount</label>
                    <span class="range-value" id="distortionValue" aria-live="polite">0.15</span>
                  </div>
                  <input type="range" id="distortionAmount" class="range-input" min="0" max="1" step="0.01" value="0.15"
                    aria-label="Harmonic distortion amount for analog warmth" aria-valuemin="0" aria-valuemax="1"
                    aria-valuenow="0.15" aria-valuetext="0.15">
                </div>

                <!-- Stereo Reduction -->
                <div class="form-group">
                  <label class="toggle">
                    <input type="checkbox" id="stereoReduction" class="toggle-input" role="switch" aria-checked="true"
                      aria-label="Enable stereo reduction for limited separation" checked>
                    <span class="toggle-switch" aria-hidden="true"></span>
                    <span>Stereo Reduction (limited separation)</span>
                  </label>
                </div>

                <div class="range-group" id="stereoWidthGroup">
                  <div class="range-label">
                    <label for="stereoWidth">Stereo Width</label>
                    <span class="range-value" id="stereoWidthValue" aria-live="polite">0.70</span>
                  </div>
                  <input type="range" id="stereoWidth" class="range-input" min="0" max="1" step="0.01" value="0.7"
                    aria-label="Stereo field width and separation (0=mono, 1=full stereo)" aria-valuemin="0"
                    aria-valuemax="1" aria-valuenow="0.7" aria-valuetext="0.70">
                </div>
              </div>

              <!-- Right Column Controls -->
              <div>
                <h4
                  style="margin-bottom: var(--space-sm); color: var(--color-text-secondary); font-size: var(--font-size-md); font-weight: var(--font-weight-medium);">
                  EQ & Filters</h4>

                <!-- Bass -->
                <div class="range-group">
                  <div class="range-label">
                    <label for="bass">Bass (100 Hz)</label>
                    <span class="range-value" id="bassValue" aria-live="polite">0.0 dB</span>
                  </div>
                  <input type="range" id="bass" class="range-input" min="-5" max="5" step="0.1" value="0"
                    aria-label="Bass EQ adjustment in decibels" aria-valuemin="-5" aria-valuemax="5" aria-valuenow="0"
                    aria-valuetext="0.0 dB">
                </div>

                <!-- Mid -->
                <div class="range-group">
                  <div class="range-label">
                    <label for="mid">Mid (1000 Hz)</label>
                    <span class="range-value" id="midValue" aria-live="polite">0.0 dB</span>
                  </div>
                  <input type="range" id="mid" class="range-input" min="-5" max="5" step="0.1" value="0"
                    aria-label="Mid EQ adjustment in decibels" aria-valuemin="-5" aria-valuemax="5" aria-valuenow="0"
                    aria-valuetext="0.0 dB">
                </div>

                <!-- Treble -->
                <div class="range-group">
                  <div class="range-label">
                    <label for="treble">Treble (8000 Hz)</label>
                    <span class="range-value" id="trebleValue" aria-live="polite">0.0 dB</span>
                  </div>
                  <input type="range" id="treble" class="range-input" min="-5" max="5" step="0.1" value="0"
                    aria-label="Treble EQ adjustment in decibels" aria-valuemin="-5" aria-valuemax="5" aria-valuenow="0"
                    aria-valuetext="0.0 dB">
                </div>

                <!-- High-Pass Filter -->
                <div class="form-group">
                  <label class="toggle">
                    <input type="checkbox" id="hpfEnabled" class="toggle-input" role="switch" aria-checked="false"
                      aria-label="Enable high-pass filter to remove low rumble">
                    <span class="toggle-switch" aria-hidden="true"></span>
                    <span>High-Pass Filter (remove rumble)</span>
                  </label>
                </div>

                <div class="range-group" id="hpfCutoffGroup">
                  <div class="range-label">
                    <label for="hpfCutoff">HPF Cutoff</label>
                    <span class="range-value" id="hpfCutoffValue" aria-live="polite">30 Hz</span>
                  </div>
                  <input type="range" id="hpfCutoff" class="range-input" min="20" max="500" step="5" value="30"
                    aria-label="High-pass filter cutoff frequency in hertz" aria-valuemin="20" aria-valuemax="500"
                    aria-valuenow="30" aria-valuetext="30 Hz">
                </div>

                <!-- Low-Pass Filter -->
                <div class="form-group">
                  <label class="toggle">
                    <input type="checkbox" id="lpfEnabled" class="toggle-input" role="switch" aria-checked="false"
                      aria-label="Enable low-pass filter for vintage warmth">
                    <span class="toggle-switch" aria-hidden="true"></span>
                    <span>Low-Pass Filter (vintage warmth)</span>
                  </label>
                </div>

                <div class="range-group" id="lpfCutoffGroup">
                  <div class="range-label">
                    <label for="lpfCutoff">LPF Cutoff</label>
                    <span class="range-value" id="lpfCutoffValue" aria-live="polite">15000 Hz</span>
                  </div>
                  <input type="range" id="lpfCutoff" class="range-input" min="5000" max="20000" step="100" value="15000"
                    aria-label="Low-pass filter cutoff frequency in hertz" aria-valuemin="5000" aria-valuemax="20000"
                    aria-valuenow="15000" aria-valuetext="15000 Hz">
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Process Button -->
        <div class="card-footer">
          <button id="processBtn" class="btn btn-primary btn-lg btn-full" disabled
            aria-label="Process audio with vinyl effects">
            Process Audio
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              style="margin-left: 8px; vertical-align: middle;" aria-hidden="true">
              <line x1="5" y1="12" x2="19" y2="12" />
              <polyline points="12 5 19 12 12 19" />
            </svg>
          </button>
        </div>
      </div>
    </section>

    <!-- Processing Indicator -->
    <section id="processingIndicator" class="section hidden animate-fadeIn" role="status" aria-live="polite"
      aria-atomic="true">
      <div class="card card-elevated text-center">
        <h3 id="processingStatus" style="color: var(--color-primary); margin-bottom: var(--space-md);">Analyzing your
          audio...</h3>
        <div class="progress-bar-container" style="margin: 0 auto var(--space-md); max-width: 400px;">
          <div class="progress-bar-bg">
            <div id="progressBar" class="progress-bar-fill" style="width: 0%;"></div>
          </div>
          <p id="progressPercent" class="text-secondary"
            style="margin-top: var(--space-sm); font-size: var(--font-size-sm);">0%</p>
        </div>
      </div>
    </section>

    <!-- Results Section -->
    <section id="resultsSection" class="section hidden animate-slideUp">
      <div class="card card-elevated card-glow gradient-border">
        <div class="card-header">
          <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
            <div style="display: flex; align-items: center; gap: var(--space-xs);">
              <span class="step-indicator">3</span>
              <div>
                <h2 class="card-title" style="margin-bottom: var(--space-xs);">Preview & Download</h2>
                <p class="card-subtitle">Your vinylified audio is ready! üéâ</p>
              </div>
            </div>
            <button class="help-btn" data-tour="results" title="Learn about previewing and downloading"
              aria-label="Help: Learn about previewing and downloading">
              ?
            </button>
          </div>
        </div>

        <div class="card-body">
          <!-- File Details -->
          <div
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-md); margin-bottom: var(--space-lg);">
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Filename</div>
              <div id="resultFileName" style="font-weight: var(--font-weight-medium); word-break: break-all;">-</div>
            </div>
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Size</div>
              <div id="resultFileSize" style="font-weight: var(--font-weight-medium);">-</div>
            </div>
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Preset</div>
              <div id="resultPreset" style="font-weight: var(--font-weight-medium);">-</div>
            </div>
            <div>
              <div class="text-muted" style="font-size: var(--font-size-sm);">Format</div>
              <div id="resultFormat" style="font-weight: var(--font-weight-medium);">-</div>
            </div>
          </div>

          <div class="alert alert-info">
            <span aria-hidden="true">‚è±Ô∏è</span> This file will expire in <strong id="expiresIn">-</strong>
          </div>

          <!-- Audio Player -->
          <div id="audioPlayerContainer" class="hidden" role="region"
            aria-label="Audio player to preview processed file"></div>

          <!-- Action Buttons -->
          <div class="btn-group" style="margin-top: var(--space-xs);">
            <button id="previewBtn" class="btn btn-secondary btn-lg" aria-label="Preview processed audio file">
              <span aria-hidden="true">üéß</span> Preview
            </button>
            <button id="metadataBtn" class="btn btn-secondary btn-lg" title="View and edit audio metadata (MP3 only)"
              aria-label="Manage audio file metadata">
              <span aria-hidden="true">üè∑Ô∏è</span> Metadata
            </button>
            <button id="downloadBtn" class="btn btn-primary btn-lg" aria-label="Download processed file">
              <span aria-hidden="true">‚¨á</span> Download
            </button>
            <button id="discardBtn" class="btn btn-ghost btn-lg" style="border: 1px solid var(--color-border);"
              aria-label="Discard audio file and start over">
              <span aria-hidden="true">üóëÔ∏è</span> Discard
            </button>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="app-footer text-center"
    style="padding: var(--space-xs) 0; border-top: 1px solid var(--color-border); background: linear-gradient(180deg, transparent 0%, rgba(212, 165, 116, 0.05) 100%);">
    <div class="container">
      <img src="assets/icons/favicon-96x96.png" alt="Vinylfy icon"
        style="width: 60px; height: 60px; margin: 0 auto var(--space-md); display: block;">
      <p
        style="font-size: var(--font-size-lg); color: var(--color-primary); font-weight: var(--font-weight-medium); margin-bottom: var(--space-sm);">
        Vinylfy
      </p>
      <p id="appVersion"
        style="font-size: var(--font-size-sm); color: var(--color-primary); font-weight: var(--font-weight-light); margin-bottom: var(--space-sm);">
        Version: v1.0.0 Beta 3</p>
      <p class="text-muted" style="font-size: var(--font-size-sm); margin-bottom: var(--space-xs);">
        Transform digital audio into warm vinyl records
      </p>
      <div
        style="display: flex; gap: var(--space-xs); justify-content: center; flex-wrap: wrap; font-size: var(--font-size-sm); color: var(--color-text-secondary);">
        <span><span aria-hidden="true">üéµ</span> Authentic Sound</span>
        <span><span aria-hidden="true">‚ö°</span> Fast Processing</span>
        <span><span aria-hidden="true">üîí</span> Privacy First</span>
        <span><span aria-hidden="true">üì±</span> PWA Ready</span>
      </div>
      <p class="text-muted" style="font-size: var(--font-size-xs); margin-top: var(--space-xs);">
        Made with ‚ù§Ô∏è for AJW and vinyl enthusiasts ‚Ä¢ <span id="fileTTL">Files auto-delete after 1 hour</span>
      </p>
    </div>
  </footer>

  <!-- Cache Update Modal -->
  <div id="cacheUpdateModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="cacheModalTitle">
    <div class="modal-overlay" aria-hidden="true"></div>
    <div class="modal-content" style="max-width: 500px;">
      <div class="modal-header">
        <h3 style="color: var(--color-primary); margin: 0;"><span aria-hidden="true">üîÑ</span>Update Available</h3>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: var(--space-md); color: var(--color-text-primary);">
          A new version of Vinylfy is available! Your browser is showing an older cached version.
        </p>
        <div
          style="background: var(--color-bg-secondary); padding: var(--space-md); border-radius: var(--radius-md); margin-bottom: var(--space-md);">
          <p style="margin: 0; font-size: var(--font-size-sm); color: var(--color-text-secondary);">
            <strong>Current cached:</strong> <span id="cachedVersion">‚Äî</span><br>
            <strong>Latest version:</strong> <span id="latestVersion">‚Äî</span>
          </p>
        </div>

        <!-- Release Notes Section -->
        <div id="releaseNotesSection" style="margin-bottom: var(--space-md); display: none;">
          <h4
            style="font-size: var(--font-size-md); color: var(--color-primary); margin-bottom: var(--space-sm); display: flex; align-items: center; gap: var(--space-xs);">
            <span aria-hidden="true">‚ú®</span> What's New In This Release
          </h4>
          <div id="releaseNotesContent"
            style="background: var(--color-bg-tertiary); padding: var(--space-md); border-radius: var(--radius-md); border-left: 3px solid var(--color-primary); max-height: 250px; overflow-y: auto;">
            <!-- Release notes will be inserted here -->
          </div>
        </div>

        <p style="font-size: var(--font-size-sm); color: var(--color-text-secondary); margin-bottom: var(--space-md);">
          Click the button below to clear your cache and reload the latest version.
        </p>
      </div>
      <div class="modal-footer" style="display: flex; gap: var(--space-sm); justify-content: flex-end;">
        <button id="dismissCacheModal" class="btn btn-ghost"
          aria-label="Close Cache Reload without clearing cache. This could result in not having the latest features.">Later</button>
        <button id="clearCacheBtn" class="btn btn-primary" aria-label="Clear browser cache and get latest updates.">
          üßπ Clear Cache & Reload
        </button>
      </div>
    </div>
  </div>

  <!-- Metadata Modal -->
  <div id="metadataModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="metadataModalTitle">
    <div class="modal-overlay" aria-hidden="true"></div>
    <div class="modal-content" style="max-width: 700px;">
      <div class="modal-header">
        <h3
          style="color: var(--color-primary); margin: 0; display: flex; align-items: center; gap: var(--space-xs); flex: 1;">
          <span aria-hidden="true">üè∑Ô∏è</span>
          <span>Audio Metadata</span>
        </h3>
        <button class="help-btn" data-tour="metadata" title="Learn about metadata management"
          aria-label="Help: Learn about metadata management">
          ?
        </button>
      </div>
      <div class="modal-body">
        <!-- Metadata Notice -->
        <div id="metadataNotice" class="alert alert-warning hidden">
          <strong>Note:</strong> Metadata editing is only available for MP3, FLAC, and AAC formats. Current format does
          not support metadata writing.
        </div>

        <!-- View Mode -->
        <div id="metadataViewMode">
          <!-- Album Artwork -->
          <div id="albumArtworkSection" class="hidden" style="margin-bottom: var(--space-lg);">
            <h4
              style="color: var(--color-text-primary); margin-bottom: var(--space-sm); font-size: var(--font-size-md);">
              Album Artwork</h4>
            <div style="display: flex; justify-content: center;">
              <img id="albumArtwork"
                style="max-width: 200px; max-height: 200px; border-radius: var(--radius-md); box-shadow: var(--shadow-lg); border: 1px solid var(--color-border);"
                alt="Album artwork">
            </div>
          </div>

          <!-- Metadata Fields -->
          <div style="display: grid; gap: var(--space-md);">
            <div class="form-row">
              <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label">Title</label>
                <input type="text" id="metaTitle" class="form-input" placeholder="No title" readonly>
              </div>
              <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label">Artist</label>
                <input type="text" id="metaArtist" class="form-input" placeholder="No artist" readonly>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label">Album</label>
                <input type="text" id="metaAlbum" class="form-input" placeholder="No album" readonly>
              </div>
              <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label">Year</label>
                <input type="text" id="metaYear" class="form-input" placeholder="No year" readonly>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label">Genre</label>
                <input type="text" id="metaGenre" class="form-input" placeholder="No genre" readonly>
              </div>
              <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label">Track Number</label>
                <input type="text" id="metaTrack" class="form-input" placeholder="No track number" readonly>
              </div>
            </div>

            <div class="form-group" style="margin-bottom: 0;">
              <label class="form-label">Comment</label>
              <textarea id="metaComment" class="form-textarea" rows="2" placeholder="No comment" readonly></textarea>
            </div>
          </div>

          <!-- Album Artwork Upload (Edit Mode) -->
          <div id="artworkUploadSection" class="hidden" style="margin-top: var(--space-md);">
            <label class="form-label">Album Artwork</label>
            <div class="file-upload">
              <input type="file" id="artworkFile" accept="image/jpeg,image/png" style="display: none;">
              <label for="artworkFile" class="file-upload-label" style="min-height: 120px; cursor: pointer;">
                <span class="file-upload-icon">üñºÔ∏è</span>
                <span class="file-upload-text">Click to upload album artwork</span>
                <span class="file-upload-hint">JPEG or PNG (recommended: 500x500px)</span>
              </label>
            </div>
            <div id="artworkPreview" class="hidden" style="margin-top: var(--space-sm); text-align: center;">
              <img id="artworkPreviewImg"
                style="max-width: 150px; max-height: 150px; border-radius: var(--radius-md); box-shadow: var(--shadow-md); border: 1px solid var(--color-border);"
                alt="Artwork preview">
              <button id="removeArtwork" class="btn btn-ghost btn-sm"
                style="display: block; margin: var(--space-sm) auto 0;">Remove Artwork</button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer" style="display: flex; justify-content: space-between; gap: var(--space-sm);">
        <button id="closeMetadataModal" class="btn btn-ghost" aria-label="Close Metadata manager window">
          Close
        </button>
        <div style="display: flex; gap: var(--space-sm);">
          <button id="editMetadataBtn" class="btn btn-secondary" aria-label="Modify audio file metadata">
            Modify Metadata
          </button>
          <button id="saveMetadataBtn" class="btn btn-primary hidden" aria-label="Save audio file metadata">
            Save Changes
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script type="module" src="/js/app.js?v=beta3"></script>
</body>

</html>